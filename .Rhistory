yearly_sales <- read.csv(
'C:/Users/Brian G. Barkley/Dropbox/PA/BrianMarkRachelSam/Data/PA_county_liquor_sales.csv',
header=T, skip=1)
yearly_sales$diff1213_1314 <- yearly_sales$DollarSalesRY2013.14-yearly_sales$DollarSalesRY2012.13
plot( yearly_sales$CountyShareRY2013.14, yearly_sales$diff1213_1314)
yearly_sales$diff1213_1314
yearly_sales$logCountyShareRY2013.14 <- log(yearly_sales$CountyShareRY2013.14)
plot( yearly_sales$logCountyShareRY2013.14 , yearly_sales$diff1213_1314)
str(map_df)
library(ggplot2)
# this creates an example formatted as your obesity.map - you have this already...
set.seed(22)    # for reproducible example
# map.county <- map_data('county')
pa_county_map_data<-map_data("county","pennsylvania")
pa_counties   <- unique(pa_county_map_data[,5:6])
sales_map <- data.frame(state_names=pa_counties$region,
county_names=pa_counties$subregion,
sales= runif(nrow(pa_counties), min=0, max=100))
# you start here...
# from URL http://stackoverflow.com/questions/23714052/ggplot-mapping-us-counties-problems-with-visualization-shapes-in-r
library(data.table)   # use data table merge - it's *much* faster
map_county <- data.table(map_data('county'))
setkey(map_county,region,subregion)
sales_map <- data.table(sales_map)
setkey(sales_map,state_names,county_names)
map_df      <- map_county[sales_map]
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales)) +
geom_polygon()+coord_map()
dev.off()
str(map_df)
nrow(pa_counties)
pa_counties
pa_counties$subregion
pa_counties$subregion == yearly_sales$County
head(yearly_sales$County)
unlist(yearly_sales$County)
c(yearly_sales$County)
as.character(yearly_sales$County)
as.character(yearly_sales$County)==pa_counties$subregion
pa_counties$subregion
length(pa_counties$subregion)
length(as.character(yearly_sales$County))
as.character(yearly_sales$County)
pa_counties$subregion
capitalize("asd")
install.packages("Hmisc")
library(Hmisc)
capitalize("asd")
library(Hmisc)
capitalize(sales_counties)
sales_counties=as.character(yearly_sales$County)
capitalize(sales_counties)
sales_counties <- sales_counties[-"TOTAL"]
sales_counties <- sales_counties[sales_counties!="TOTAL"]
sales_counties
sales_counties %in% pa_counties$subregion
pa_counties$subregion
sales_counties
?tolower()
sales_counties <- tolower(sales_counties)
sales_counties <- sales_counties[sales_counties!="TOTAL"]
sales_counties <- sales_counties[sales_counties!="total"]
sales_counties %in% pa_counties$subregion
order(pa_counties)
sales_counties[order(pa_counties)]
sales_counties[order(pa_counties$subregion)]
pa_counties$subregion
order(pa_counties$subregion)
sort(pa_counties$subregion)
sales_counties== sort(pa_counties$subregion)
sort(pa_counties$subregion)
sales_counties
match(sales_counties,pa_counties$subregion)
sales_counties[match(sales_counties,pa_counties$subregion)]
sales_counties[match(pa_counties$subregion,sales_counties)]
sales_counties[match(pa_counties$subregion,sales_counties)]==pa_counties$subregion
all(sales_counties[match(pa_counties$subregion,sales_counties)]==pa_counties$subregion)
sales_to_map_order <- match(pa_counties$subregion,sales_counties)
yr_sales <- yearly_sales[,sales_to_map_order]
yr_sales <- yearly_sales[sales_to_map_order,]
all(tolower(yr_sales$County)==pa_counties$subregion)
library(ggplot2)
# this creates an example formatted as your obesity.map - you have this already...
set.seed(22)    # for reproducible example
# map.county <- map_data('county')
pa_county_map_data<-map_data("county","pennsylvania")
pa_counties   <- unique(pa_county_map_data[,5:6])
sales_map <- data.frame(state_names=pa_counties$region,
county_names=pa_counties$subregion,
sales_13    = yr_sales$DollarSalesRY2012.13,
sales_14    = yr_sales$DollarSalesRY2013.14,
sales_diff  = yr_sales$diff1213_1314,
sales_share = yr_sales$CountyShareRY2013.14,
sales_logshare = yr_sales$logCountyShareRY2013.14)
#runif(nrow(pa_counties), min=0, max=100))
# you start here...
# from URL http://stackoverflow.com/questions/23714052/ggplot-mapping-us-counties-problems-with-visualization-shapes-in-r
library(data.table)   # use data table merge - it's *much* faster
map_county <- data.table(map_data('county'))
setkey(map_county,region,subregion)
sales_map <- data.table(sales_map)
setkey(sales_map,state_names,county_names)
map_df      <- map_county[sales_map]
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon()+coord_map()
dev.off()
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon()+coord_map()
dev.off()
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon()+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon()+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon()+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="black")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="green")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="light pink")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="light purple")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="purple")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="purple")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="purple")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#6600CC")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#0033CC")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#009966")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#00CCCC")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#003333")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County") +
guides(fill = guide_legend(reverse=TRUE))
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County") +
guides(fill = guide_legend(reverse=TRUE))
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County") +
guides(fill = guide_legend(reverse=TRUE))
?scale_color_brewer()]
?scale_color_brewer()
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")+
scale_colour_gradient2(high=muted("green"))
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")+
scale_colour_gradient2(high=("green"))
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")+
scale_colour_gradient2(low="red", high="blue")
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#111111")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#FFFFFF")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=grou
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#FFFFFF")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#FFFFFF")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#336666")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#9933FF")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#6600FF")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
pdf("maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#FFFFFF")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#6600FF")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
setwd('C:/Users/Brian G. Barkley/Dropbox/PA/BrianMarkRachelSam/')
library(ggplot2)
# this creates an example formatted as your obesity.map - you have this already...
set.seed(22)    # for reproducible example
# map.county <- map_data('county')
pa_county_map_data<-map_data("county","pennsylvania")
pa_counties   <- unique(pa_county_map_data[,5:6])
sales_map <- data.frame(state_names=pa_counties$region,
county_names=pa_counties$subregion,
sales_13    = yr_sales$DollarSalesRY2012.13,
sales_14    = yr_sales$DollarSalesRY2013.14,
sales_diff  = yr_sales$diff1213_1314,
sales_share = yr_sales$CountyShareRY2013.14,
sales_logshare = yr_sales$logCountyShareRY2013.14)
#runif(nrow(pa_counties), min=0, max=100))
# you start here...
# from URL http://stackoverflow.com/questions/23714052/ggplot-mapping-us-counties-problems-with-visualization-shapes-in-r
library(data.table)   # use data table merge - it's *much* faster
map_county <- data.table(map_data('county'))
setkey(map_county,region,subregion)
sales_map <- data.table(sales_map)
setkey(sales_map,state_names,county_names)
map_df      <- map_county[sales_map]
pdf("Plots/maptest.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
pdf("Plots/SalesMap.pdf", 8,5)
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_14)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2014 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_13)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013 Liquor Sales by County")
ggplot(map_df, aes(x=long, y=lat, group=group, fill=sales_diff)) +
geom_polygon(col="#000000")+coord_map() +
ggtitle("2013-2014 Change in Liquor Sales by County")
dev.off()
yr_sales$diff1213_1314
